/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={500:(e,t)=>{var a;!function(){"use strict";var o={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var a=arguments[t];a&&(e=i(e,l(a)))}return e}function l(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var a in e)o.call(e,a)&&e[a]&&(t=i(t,a));return t}function i(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(a=function(){return n}.apply(t,[]))||(e.exports=a)}()}},t={};function a(o){var n=t[o];if(void 0!==n)return n.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,a),l.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.element,t=window.wp.i18n,o=window.wp.blocks,n=window.wp.blockEditor;function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)({}).hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},l.apply(null,arguments)}const i=window.qlttf.store;var r=a(500),c=a.n(r);const s=window.wp.components,d=window.wp.compose,m=a=>{const{attributes:o,setAttributes:l}=a,[r,m]=(0,e.useState)(o.hashtag),[u,k]=(0,e.useState)(o.username),[p,f]=(0,e.useState)(o.region),[_,g]=(0,e.useState)(o.limit),h=(0,d.useDebounce)((e=>{l({hashtag:e})}),1e3),w=(0,d.useDebounce)((e=>{l({username:e})}),1e3),E=(0,d.useDebounce)((e=>{l({region:e})}),1e3),b=(0,d.useDebounce)((e=>{l({limit:e})}),1e3);(0,e.useEffect)((()=>{h(r)}),[r,h]),(0,e.useEffect)((()=>{w(u)}),[u,w]),(0,e.useEffect)((()=>{E(p)}),[p,E]),(0,e.useEffect)((()=>{b(_)}),[_,b]);const{accounts:C}=(0,i.useAccountsEntities)(),v=qlttf_gutenberg.image_url,y=C?.find((e=>e.open_id===o.open_id)),[x,N]=(0,e.useState)(!1);return(0,e.createElement)(n.InspectorControls,{key:"inspector"},(0,e.createElement)(s.PanelBody,{initialOpen:!0,title:(0,t.__)("Cache","wp-tiktok-feed")},(0,e.createElement)(s.Button,{variant:"secondary",onClick:async()=>{confirm((0,t.__)("You are about to reset the cache of this feed.","wp-tiktok-feed"))&&(N(!0),await(0,i.clearFeedCache)({method:"POST",data:{feedSettings:o}}),N(!1))}},(0,t.__)("Clear cache","wp-tiktok-feed")),x&&(0,e.createElement)("span",{style:{visibility:"visible",position:"absolute"},className:"spinner"})),(0,e.createElement)(s.PanelBody,{initialOpen:!0,title:(0,t.__)("General","wp-tiktok-feed")},(0,e.createElement)(s.SelectControl,{label:(0,t.__)("Feed","wp-tiktok-feed"),value:o.source,onChange:e=>l({source:e}),options:[{value:"account",label:(0,t.__)("Account","wp-tiktok-feed")},{value:"username",label:(0,t.__)("Username","wp-tiktok-feed")},{value:"hashtag",label:(0,t.__)("Hashtag","wp-tiktok-feed")},{value:"trending",label:(0,t.__)("Trending","wp-tiktok-feed")}]}),"account"===o.source&&(0,e.createElement)(s.SelectControl,{label:(0,t.__)("Account","wp-tiktok-feed"),help:(0,t.__)("Please select an account","wp-tiktok-feed"),value:o.open_id,onChange:e=>l({open_id:e}),options:C?.map((e=>({value:e.open_id,label:e.nickname||e.username})))}),"hashtag"===o.source&&(0,e.createElement)(s.TextControl,{label:(0,t.__)("Hashtag","wp-tiktok-feed"),help:(0,t.__)("Please enter a hashtag","wp-tiktok-feed"),value:r,onChange:function(e){m(e)}}),"username"===o.source&&(0,e.createElement)(s.TextControl,{label:(0,t.__)("Username","wp-tiktok-feed"),help:(0,t.__)("Please enter a tiktok account name","wp-tiktok-feed"),value:u,onChange:function(e){k(e)}}),"trending"===o.source&&(0,e.createElement)(s.TextControl,{label:(0,t.__)("Region","wp-tiktok-feed"),help:(0,e.createElement)("a",{target:"_blank",rel:"noreferrer noopener",href:"https://www.iso.org/obp/ui/#search/code/"},(0,t.__)("Please enter a region country in Alpha-2 standard. You can find more information about it here.","wp-tiktok-feed")),value:p,onChange:function(e){f(e)}}),(0,e.createElement)(e.Fragment,null,(0,e.createElement)("ul",{className:"qlttf-list-videos"},["gallery","masonry","carousel","carousel-vertical","highlight","highlight-square"].map(((t,a)=>(0,e.createElement)("li",{key:a,className:c()("qlttf-modal-image",o.layout===t&&"active","masonry"!==t&&"gallery"!==t&&"qlttf-premium-field"),onClick:()=>l({layout:t})},(0,e.createElement)("span",null,t.replace("-"," ")),(0,e.createElement)("img",{alt:t,src:`${v}/${t}.png`})))))),(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Limit","wp-tiktok-feed"),help:(0,t.__)("Number of videos to display","wp-tiktok-feed"),value:_,onChange:function(e){g(e)},min:1,max:33}),!["carousel","carousel-vertical"].includes(o.layout)&&(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Columns","wp-tiktok-feed"),help:(0,t.__)("Number of videos in a row","wp-tiktok-feed"),value:o.columns,onChange:e=>l({columns:e}),min:1,max:20}),["highlight","highlight-square"].includes(o.layout)&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.TextControl,{label:(0,t.__)(" highlight by tag","wp-tiktok-feed"),help:(0,t.__)("Highlight feeds items with this tags","wp-tiktok-feed"),value:o.highlight.tag,onChange:e=>l({highlight:{...o.highlight,tag:e}})}),(0,e.createElement)(s.TextControl,{label:(0,t.__)(" highlight by id","wp-tiktok-feed"),help:(0,t.__)(" highlight by id","wp-tiktok-feed"),value:o.highlight.id,onChange:e=>l({highlight:{...o.highlight,id:e}})}),(0,e.createElement)(s.TextControl,{label:(0,t.__)(" highlight by position","wp-tiktok-feed"),help:(0,t.__)("Highlight feeds items in this positions","wp-tiktok-feed"),value:o.highlight.position,onChange:e=>l({highlight:{...o.highlight,position:e}})}))),["carousel","carousel-vertical"].includes(o.layout)&&(0,e.createElement)(s.PanelBody,{initialOpen:!1,title:(0,t.__)("Carousel","wp-tiktok-feed")},(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Slides per view","wp-tiktok-feed"),help:(0,t.__)("Number of Videos per slide","wp-tiktok-feed"),value:o.carousel.slidespv,onChange:e=>l({carousel:{...o.carousel,slidespv:e}}),min:1,max:10}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Autoplay","wp-tiktok-feed"),help:(0,t.__)("Autoplay carousel items","wp-tiktok-feed"),checked:!!o.carousel.autoplay,onChange:e=>l({carousel:{...o.carousel,autoplay:e}})}),o.carousel.autoplay&&(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Autoplay Interval","wp-tiktok-feed"),help:(0,t.__)("Move to the next picture after a specified time interval","wp-tiktok-feed"),value:o.carousel.autoplay_interval,onChange:e=>l({carousel:{...o.carousel,autoplay_interval:e}}),min:1e3,max:3e5,step:100}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Navigation","wp-tiktok-feed"),help:(0,t.__)("Display navigation arrows","wp-tiktok-feed"),checked:!!o.carousel.navarrows,onChange:e=>l({carousel:{...o.carousel,navarrows:e}})}),o.carousel.navarrows&&(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Navigation color","wp-tiktok-feed"),help:(0,t.__)("Change navigation arrows color","wp-tiktok-feed")},(0,e.createElement)(n.ColorPalette,{value:o.carousel.navarrows_color,onChange:e=>l({carousel:{...o.carousel,navarrows_color:e}})})),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Pagination","wp-tiktok-feed"),help:(0,t.__)("Display pagination dots","wp-tiktok-feed"),checked:!!o.carousel.pagination,onChange:e=>l({carousel:{...o.carousel,pagination:e}})}),o.carousel.pagination&&(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Pagination color","wp-tiktok-feed"),help:(0,t.__)("Change pagination dots color","wp-tiktok-feed")},(0,e.createElement)(n.ColorPalette,{value:o.carousel.pagination_color,onChange:e=>l({carousel:{...o.carousel,pagination_color:e}})}))),(0,e.createElement)(s.PanelBody,{initialOpen:!1,title:(0,t.__)("Box","wp-tiktok-feed")},(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Display","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Display the TikTok Feed inside a customizable box","wp-tiktok-feed"),checked:!!o.box.display,onChange:e=>l({box:{...o.box,display:e}})}),o.box.display&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Padding","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Add padding to the box","wp-tiktok-feed"),value:o.box.padding,onChange:e=>l({box:{...o.box,padding:e}}),min:0,max:300}),(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Radius","wp-tiktok-feed"),help:(0,t.__)("Add radius to the box","wp-tiktok-feed"),className:"qlttf-premium-field",value:o.box.radius,onChange:e=>l({box:{...o.box,radius:e}}),min:0,max:1e3}),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Background","wp-tiktok-feed"),help:(0,t.__)("Change background color in box","wp-tiktok-feed"),className:"qlttf-premium-field"},(0,e.createElement)(n.ColorPalette,{value:o.box.background,onChange:e=>l({box:{...o.box,background:e}})})),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Text color","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Change text color in box","wp-tiktok-feed")},(0,e.createElement)(n.ColorPalette,{value:o.box.text_color,onChange:e=>l({box:{...o.box,text_color:e}})})))),(0,e.createElement)(s.PanelBody,{initialOpen:!1,title:(0,t.__)("Profile","wp-tiktok-feed")},(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Display","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Display user profile or tag info","wp-tiktok-feed"),checked:!!o.profile.display,onChange:e=>l({profile:{...o.profile,display:e}})}),o.profile.display&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.TextControl,{label:(0,t.__)("Nickname","wp-tiktok-feed"),help:(0,t.__)("Profile Nickname","wp-tiktok-feed"),value:o.profile.nickname,onChange:e=>{l({profile:{...o.profile,nickname:e}})}}),(0,e.createElement)(s.TextControl,{label:(0,t.__)("Username","wp-tiktok-feed"),help:(0,t.__)("Profile username","wp-tiktok-feed"),value:o.profile.username,onChange:e=>{l({profile:{...o.profile,username:e}})}}),(0,e.createElement)(s.TextControl,{label:(0,t.__)("Link Text","wp-tiktok-feed"),help:(0,t.__)("Link text here","wp-tiktok-feed"),value:o.profile.link_text,placeholder:"TikTok",onChange:e=>{l({profile:{...o.profile,link_text:e}})}}),(0,e.createElement)(s.TextareaControl,{label:(0,t.__)("Biography","wp-tiktok-feed"),help:(0,t.__)("Profile description here","wp-tiktok-feed"),value:o.profile.biography,onChange:e=>{l({profile:{...o.profile,biography:e}})}}),(0,e.createElement)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},(0,e.createElement)("img",{alt:"",width:"150",height:"150",src:o.profile.avatar||y.avatar||"http://2.gravatar.com/avatar/b642b4217b34b1e8d3bd915fc65c4452?s=150&d=mm&r=g"}),(0,e.createElement)(n.MediaUpload,{onSelect:e=>{l({profile:{...o.profile,avatar:e.url}})},allowedTypes:["image"],value:o.profile.avatar,render:({open:a})=>(0,e.createElement)("div",null,(0,e.createElement)(s.Button,{style:{margin:"15px 5px 15px 0"},variant:"secondary",onClick:a},(0,t.__)("Upload","wp-tiktok-feed")),(0,e.createElement)(s.Button,{style:{margin:"15px 0"},variant:"secondary",disabled:!o.profile.avatar||o.profile.avatar===y.avatar,onClick:()=>{l({profile:{...o.profile,avatar:y.avatar||""}})}},"×"))})))),(0,e.createElement)(s.PanelBody,{initialOpen:!1,title:(0,t.__)("Video","wp-tiktok-feed")},(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Spacing","wp-tiktok-feed"),help:(0,t.__)("Add spacing between videos","wp-tiktok-feed"),value:o.video.spacing,onChange:e=>l({video:{...o.video,spacing:e}}),min:0,max:50}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Lazy load","wp-tiktok-feed"),help:(0,t.__)("Defers video lazy","wp-tiktok-feed"),checked:!!o.lazy,onChange:e=>l({lazy:e})}),(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Radius","wp-tiktok-feed"),help:(0,t.__)("Add radius to Videos","wp-tiktok-feed"),value:o.video.radius,onChange:e=>l({video:{...o.video,radius:e}}),min:0,max:50}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Mask","wp-tiktok-feed"),help:(0,t.__)("Display mask on hover","wp-tiktok-feed"),checked:!!o.mask.display,onChange:e=>l({mask:{...o.mask,display:e}})}),o.mask.display&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Mask background","wp-tiktok-feed"),help:(0,t.__)("Change background color in mask","wp-tiktok-feed")},(0,e.createElement)(n.ColorPalette,{value:o.mask.background,onChange:e=>l({mask:{...o.mask,background:e}})})),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Likes","wp-tiktok-feed"),help:(0,t.__)("Display likes count in mask","wp-tiktok-feed"),checked:!!o.mask.likes_count,onChange:e=>l({mask:{...o.mask,likes_count:e}})}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Comments","wp-tiktok-feed"),help:(0,t.__)("Display comments count in mask","wp-tiktok-feed"),checked:!!o.mask.comments_count,onChange:e=>l({mask:{...o.mask,comments_count:e}})}))),(0,e.createElement)(s.PanelBody,{initialOpen:!1,title:(0,t.__)("Card","wp-tiktok-feed")},(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Display","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Display card in video","wp-tiktok-feed"),checked:!!o.card.display,onChange:e=>l({card:{...o.card,display:e}})}),o.card.display&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Radius","wp-tiktok-feed"),help:(0,t.__)("Add radius to the card","wp-tiktok-feed"),className:"qlttf-premium-field",value:o.card.radius,onChange:e=>l({card:{...o.card,radius:e}}),min:0,max:1e3}),(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Font size","wp-tiktok-feed"),help:(0,t.__)("Change font size in cards","wp-tiktok-feed"),className:"qlttf-premium-field",value:o.card.font_size,onChange:e=>l({card:{...o.card,font_size:e}}),min:8,max:36}),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Background","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Change background color in cards","wp-tiktok-feed")},(0,e.createElement)(n.ColorPalette,{value:o.card.background,onChange:e=>l({card:{...o.card,background:e}})})),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Background hover","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Change background color hover in cards","wp-tiktok-feed")},(0,e.createElement)(n.ColorPalette,{value:o.card.background_hover,onChange:e=>l({card:{...o.card,background_hover:e}})})),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Text color","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Change text color","wp-tiktok-feed")},(0,e.createElement)(n.ColorPalette,{value:o.card.text_color,onChange:e=>l({card:{...o.card,text_color:e}})})),(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Padding","wp-tiktok-feed"),help:(0,t.__)("Add padding in cards","wp-tiktok-feed"),className:"qlttf-premium-field",value:o.card.padding,onChange:e=>l({card:{...o.card,padding:e}}),min:0,max:20}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Likes","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Display likes count in cards","wp-tiktok-feed"),checked:!!o.card.likes_count,onChange:e=>l({card:{...o.card,likes_count:e}})}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Comments","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Display comments count in cards","wp-tiktok-feed"),checked:!!o.card.comments_count,onChange:e=>l({card:{...o.card,comments_count:e}})}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Description","wp-tiktok-feed"),className:"qlttf-premium-field",help:(0,t.__)("Display description in cards","wp-tiktok-feed"),checked:!!o.card.video_description,onChange:e=>l({card:{...o.card,video_description:e}})}),(0,e.createElement)(s.RangeControl,{label:(0,t.__)("Length","wp-tiktok-feed"),help:(0,t.__)("Limit the length of the description in the card","wp-tiktok-feed"),className:"qlttf-premium-field",value:o.card.max_word_count,onChange:e=>l({card:{...o.card,max_word_count:e}}),min:1,max:100}))),(0,e.createElement)(s.PanelBody,{initialOpen:!1,title:(0,t.__)("Modal","wp-tiktok-feed")},(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Display","wp-tiktok-feed"),help:(0,t.__)("Display Modal by clicking on video","wp-tiktok-feed"),checked:!!o.modal.display,onChange:e=>l({modal:{...o.modal,display:e}})}),o.modal.display&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Profile","wp-tiktok-feed"),help:(0,t.__)("Display user profile or tag info","wp-tiktok-feed"),checked:!!o.modal.profile,onChange:e=>l({modal:{...o.modal,profile:e}})}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Description","wp-tiktok-feed"),help:(0,t.__)("Display description in the sidebar","wp-tiktok-feed"),checked:!!o.modal.video_description,onChange:e=>l({modal:{...o.modal,video_description:e}})}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Likes","wp-tiktok-feed"),help:(0,t.__)("Display likes count in sidebar","wp-tiktok-feed"),checked:!!o.modal.likes_count,onChange:e=>l({modal:{...o.modal,likes_count:e}})}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Comments","wp-tiktok-feed"),help:(0,t.__)("Display comments count in sidebar","wp-tiktok-feed"),checked:!!o.modal.comments_count,onChange:e=>l({modal:{...o.modal,comments_count:e}})}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Date","wp-tiktok-feed"),help:(0,t.__)("Display video date","wp-tiktok-feed"),checked:!!o.modal.date,onChange:e=>l({modal:{...o.modal,date:e}})}),"account"===o.source&&(0,e.createElement)("p",{className:"form-field"},(0,e.createElement)("span",{className:"notice error",style:{marginleft:"0",marginright:"0",paddingtop:" 10px",paddingbottom:" 10px",display:" flex",justifycontent:" left",alignitems:" center"}},(0,e.createElement)("small",null,(0,t.__)("Due to Tiktok limitations, controls and autoplay options are not available in account source.","wp-tiktok-feed")))),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Controls","wp-tiktok-feed"),help:(0,t.__)("Display video controls","wp-tiktok-feed"),checked:o.modal.controls,disabled:"account"===o.source,onChange:e=>l({modal:{...o.modal,controls:e}})}),(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Autoplay","wp-tiktok-feed"),help:(0,t.__)("Video autoplay when modal is open.","wp-tiktok-feed"),checked:o.modal.autoplay,disabled:"account"===o.source,onChange:e=>l({modal:{...o.modal,autoplay:e}})}),(0,e.createElement)(s.SelectControl,{label:(0,t.__)("Text align","wp-tiktok-feed"),help:(0,t.__)("Align description in sidebar","wp-tiktok-feed"),value:o.modal.align||"",onChange:e=>l({modal:{...o.modal,align:e}}),options:[{value:"left",label:(0,t.__)("Left","wp-tiktok-feed")},{value:"center",label:(0,t.__)("Center","wp-tiktok-feed")},{value:"right",label:(0,t.__)("Right","wp-tiktok-feed")}]}))),(0,e.createElement)(s.PanelBody,{initialOpen:!1,title:(0,t.__)("Button","wp-tiktok-feed")},(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Display","wp-tiktok-feed"),help:(0,t.__)("Display the button to open tikTok site link","wp-tiktok-feed"),checked:!!o.button.display,onChange:e=>l({button:{...o.button,display:e}})}),o.button.display&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.TextControl,{label:(0,t.__)("Text","wp-tiktok-feed"),help:(0,t.__)("Change button text","wp-tiktok-feed"),placeholder:"TikTok",value:o.button.text,onChange:e=>l({button:{...o.button,text:e}})}),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Text color","wp-tiktok-feed"),help:(0,t.__)("Change color text in button","wp-tiktok-feed")},(0,e.createElement)(n.ColorPalette,{value:o.button.text_color,onChange:e=>l({button:{...o.button,text_color:e}})})),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Background","wp-tiktok-feed"),help:(0,t.__)("Change background color in button","wp-tiktok-feed")},(0,e.createElement)(n.ColorPalette,{value:o.button.background,onChange:e=>l({button:{...o.button,background:e}})})),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Background hover","wp-tiktok-feed"),help:(0,t.__)("Change background hover in button","wp-tiktok-feed")},(0,e.createElement)(n.ColorPalette,{value:o.button.background_hover,onChange:e=>l({button:{...o.button,background_hover:e}})})))),["account","username","hashtag"].includes(o.source)&&(0,e.createElement)(s.PanelBody,{initialOpen:!1,title:(0,t.__)("Button load more","wp-tiktok-feed")},(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("Display","wp-tiktok-feed"),help:(0,t.__)("Display the button to load more feeds","wp-tiktok-feed"),className:"qlttf-premium-field",checked:!!o.button_load.display,onChange:e=>l({button_load:{...o.button_load,display:e}})}),o.button_load.display&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.TextControl,{label:(0,t.__)("Text","wp-tiktok-feed"),help:(0,t.__)("Change button text","wp-tiktok-feed"),className:"qlttf-premium-field",value:o.button_load.text,onChange:e=>l({button_load:{...o.button_load,text:e}})}),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Text color","wp-tiktok-feed"),help:(0,t.__)("Change color text in button","wp-tiktok-feed"),className:"qlttf-premium-field"},(0,e.createElement)(n.ColorPalette,{value:o.button_load.text_color,onChange:e=>l({button_load:{...o.button_load,text_color:e}})})),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Background","wp-tiktok-feed"),help:(0,t.__)("Change background color in button","wp-tiktok-feed"),className:"qlttf-premium-field"},(0,e.createElement)(n.ColorPalette,{value:o.button_load.background,onChange:e=>l({button_load:{...o.button_load,background:e}})})),(0,e.createElement)(s.BaseControl,{label:(0,t.__)("Background hover","wp-tiktok-feed"),help:(0,t.__)("Change background hover in button","wp-tiktok-feed"),className:"qlttf-premium-field"},(0,e.createElement)(n.ColorPalette,{value:o.button_load.background_hover,onChange:e=>l({button_load:{...o.button_load,background_hover:e}})})))))},u=(0,e.createContext)({}),k=()=>(0,e.useContext)(u),p=(e,t)=>{switch(t.type){case"SET_CURRENT_FEED_INDEX":case"SET_IS_OPEN":case"SET_IS_IMAGE_LOAD":return{...e,...t.payload}}},f=t=>{const{children:a}=t,[o,n]=(0,e.useReducer)(p,{currentFeedIndex:0,setIsOpen:!1});return(0,e.createElement)(u.Provider,{value:{...o,setCurrentFeedIndex:e=>{o.currentFeedIndex!=e&&n({type:"SET_CURRENT_FEED_INDEX",payload:{currentFeedIndex:e}})},setIsOpen:e=>{o.isOpen!=e&&n({type:"SET_IS_OPEN",payload:{isOpen:e}})},setIsImageLoad:e=>{o.isImageLoad!=e&&n({type:"SET_IS_IMAGE_LOAD",payload:{isImageLoad:e}})}}},a)},_=(u.Consumer,(0,e.createElement)("svg",{width:"34px",height:"39px",viewBox:"0 0 34 39",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},(0,e.createElement)("g",{id:"logo",fillRule:"nonzero"},(0,e.createElement)("path",{d:"M14,15.5986129 L14,14.1133768 C13.4492134,14.040368 12.8937601,14.0024884 12.3374825,14 C5.53458031,14 0,19.1804477 0,25.5469912 C0,29.4523859 2.08560208,32.9095062 5.26712374,35 C3.13682443,32.8679456 1.95248926,30.057585 1.95420355,27.138627 C1.95420355,20.862785 7.33129202,15.7451306 14,15.5986129",id:"路径",fill:"#00F2EA"}),(0,e.createElement)("path",{d:"M14.3270124,32 C17.2025642,32 19.5483859,29.7265698 19.6552148,26.893337 L19.6649265,1.60131615 L24.3141914,1.60131615 C24.2149367,1.07323659 24.1646956,0.537213101 24.1641012,0 L17.8144025,0 L17.8038079,25.2928983 C17.6978619,28.1252536 15.3511573,30.3978064 12.4764884,30.3978064 C11.6134296,30.3981458 10.7633314,30.1891169 10,29.7888676 C10.9999544,31.1753424 12.6105704,31.998378 14.3270124,32 M32.9991171,10.1861256 L32.9991171,8.7804771 C31.2904862,8.78205509 29.6185303,8.28804731 28.1882845,7.35903482 C29.4422255,8.79389849 31.1305958,9.78588899 33,10.1861256",id:"形状",fill:"#00F2EA"}),(0,e.createElement)("path",{d:"M28,7.71784336 C26.6016465,6.13450916 25.8314253,4.10280973 25.8323547,2 L24.1350558,2 C24.579153,4.34872233 25.9758497,6.41501163 28,7.71784336 M12.3253083,20.0652472 C9.38563022,20.0686094 7.00339763,22.426024 7,25.3350766 C7.00190968,27.2938688 8.10083201,29.0902144 9.85378743,30 C9.1988984,29.1062913 8.84622242,28.0306091 8.84615385,26.9266592 C8.84906616,24.0172662 11.2314406,21.6593213 14.1714621,21.6559582 C14.7201996,21.6559582 15.2460364,21.7457353 15.7428068,21.9000125 L15.7428068,15.4996887 C15.2222255,15.4267223 14.6972334,15.3888647 14.1714621,15.3863778 C14.0789783,15.3863778 13.988256,15.3916075 13.896653,15.3933508 L13.896653,20.3093015 C13.388489,20.1492295 12.8585935,20.0669285 12.3253083,20.0652472",id:"形状",fill:"#FF004F"}),(0,e.createElement)("path",{d:"M32.1532084,11.0008735 L32.1532084,15.8838834 C28.868262,15.8838834 25.8255034,14.841767 23.3402168,13.072877 L23.3402168,25.8412053 C23.3402168,32.2179445 18.1107231,37.4058149 11.6817395,37.4058149 C9.19733366,37.4058149 6.89346776,36.6283768 5,35.3093527 C7.2006955,37.6633081 10.2910883,39.0007866 13.5276504,39 C19.956634,39 25.1870084,33.8121292 25.1870084,27.4362636 L25.1870084,14.6679353 C27.7544407,16.4991162 30.8377082,17.4825603 34,17.4789417 L34,11.1947963 C33.3659085,11.1947963 32.7494306,11.1266613 32.1532084,11",id:"路径",fill:"#FF004F"}),(0,e.createElement)("path",{d:"M23.9786547,25.4190568 L23.9786547,12.6326996 C26.6066739,14.4666805 29.7629082,15.4515361 33,15.4476752 L33,10.5577705 C31.0913787,10.1583421 29.3677274,9.16907377 28.0877076,7.7384212 C26.0159757,6.43090073 24.5864469,4.3571751 24.1319103,2 L19.384593,2 L19.3746765,27.2149377 C19.2655946,30.0386608 16.8702998,32.3051622 13.934103,32.3051622 C12.1814976,32.3034007 10.5369778,31.4829054 9.51583447,30.1007687 C7.7213232,29.1879457 6.59619217,27.3850884 6.59406171,25.4190568 C6.59753921,22.4995348 9.03577081,20.1336362 12.0445517,20.1302619 C12.6052869,20.1302619 13.1434845,20.2194873 13.6528339,20.3751945 L13.6528339,15.4415519 C7.20167505,15.5885114 2,20.7215992 2,27.0163673 C2,30.0605298 3.2188327,32.8317673 5.20484485,34.9014479 C7.20695433,36.2690564 9.59610241,37.0020908 12.0445517,37 C18.6255271,37 23.9786547,31.8047999 23.9786547,25.4190568",id:"路径",fill:"#FFFFFF"}))))),g=(0,e.createElement)("svg",{width:"12px",height:"14px",viewBox:"0 0 29 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("g",{id:"页面1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},(0,e.createElement)("g",{id:"编组-2",transform:"translate(0.979236, 0.000000)",fillRule:"nonzero"},(0,e.createElement)("path",{d:"M10.7907645,12.33 L10.7907645,11.11 C10.3672629,11.0428887 9.93950674,11.0061284 9.51076448,10.9999786 C5.35996549,10.9912228 1.68509679,13.6810205 0.438667694,17.6402658 C-0.807761399,21.5995112 0.663505842,25.9093887 4.07076448,28.28 C1.51848484,25.5484816 0.809799545,21.5720834 2.26126817,18.1270053 C3.71273679,14.6819273 7.05329545,12.4115428 10.7907645,12.33 L10.7907645,12.33 Z",id:"路径",fill:"#25F4EE"}),(0,e.createElement)("path",{d:"M11.0207645,26.15 C13.3415287,26.1468776 15.2491662,24.3185414 15.3507645,22 L15.3507645,1.31 L19.1307645,1.31 C19.0536068,0.877682322 19.0167818,0.439130992 19.0207645,0 L13.8507645,0 L13.8507645,20.67 C13.764798,23.0003388 11.8526853,24.846212 9.52076448,24.85 C8.82390914,24.844067 8.13842884,24.6726969 7.52076448,24.35 C8.33268245,25.4749154 9.63346203,26.1438878 11.0207645,26.15 Z",id:"路径",fill:"#25F4EE"}),(0,e.createElement)("path",{d:"M26.1907645,8.33 L26.1907645,7.18 C24.79964,7.18047625 23.4393781,6.76996242 22.2807645,6 C23.2964446,7.18071769 24.6689622,7.99861177 26.1907645,8.33 L26.1907645,8.33 Z",id:"路径",fill:"#25F4EE"}),(0,e.createElement)("path",{d:"M22.2807645,6 C21.1394675,4.70033161 20.5102967,3.02965216 20.5107645,1.3 L19.1307645,1.3 C19.4909812,3.23268519 20.6300383,4.93223067 22.2807645,6 L22.2807645,6 Z",id:"路径",fill:"#FE2C55"}),(0,e.createElement)("path",{d:"M9.51076448,16.17 C7.51921814,16.1802178 5.79021626,17.544593 5.31721201,19.4791803 C4.84420777,21.4137677 5.74860956,23.4220069 7.51076448,24.35 C6.55594834,23.0317718 6.42106871,21.2894336 7.16162883,19.8399613 C7.90218896,18.3904889 9.39306734,17.4787782 11.0207645,17.48 C11.4547752,17.4854084 11.8857908,17.5527546 12.3007645,17.68 L12.3007645,12.42 C11.8769919,12.3565056 11.4492562,12.3230887 11.0207645,12.32 L10.7907645,12.32 L10.7907645,16.32 C10.3736368,16.2081544 9.94244934,16.1576246 9.51076448,16.17 Z",id:"路径",fill:"#FE2C55"}),(0,e.createElement)("path",{d:"M26.1907645,8.33 L26.1907645,12.33 C23.61547,12.3250193 21.107025,11.5098622 19.0207645,10 L19.0207645,20.51 C19.0097352,25.7544158 14.7551919,30.0000116 9.51076448,30 C7.56312784,30.0034556 5.66240321,29.4024912 4.07076448,28.28 C6.72698674,31.1368108 10.8608257,32.0771989 14.4914706,30.6505586 C18.1221155,29.2239183 20.5099375,25.7208825 20.5107645,21.82 L20.5107645,11.34 C22.604024,12.8399663 25.1155724,13.6445013 27.6907645,13.64 L27.6907645,8.49 C27.1865925,8.48839535 26.6839313,8.43477816 26.1907645,8.33 Z",id:"路径",fill:"#FE2C55"}),(0,e.createElement)("path",{d:"M19.0207645,20.51 L19.0207645,10 C21.1134087,11.5011898 23.6253623,12.3058546 26.2007645,12.3 L26.2007645,8.3 C24.6792542,7.97871265 23.3034403,7.17147491 22.2807645,6 C20.6300383,4.93223067 19.4909812,3.23268519 19.1307645,1.3 L15.3507645,1.3 L15.3507645,22 C15.2751521,23.8467664 14.0381991,25.4430201 12.268769,25.9772302 C10.4993389,26.5114403 8.58570942,25.8663815 7.50076448,24.37 C5.73860956,23.4420069 4.83420777,21.4337677 5.30721201,19.4991803 C5.78021626,17.564593 7.50921814,16.2002178 9.50076448,16.19 C9.934903,16.1938693 10.3661386,16.2612499 10.7807645,16.39 L10.7807645,12.39 C7.0223379,12.4536691 3.65653929,14.7319768 2.20094561,18.1976761 C0.745351938,21.6633753 1.47494493,25.6617476 4.06076448,28.39 C5.66809542,29.4755063 7.57158782,30.0378224 9.51076448,30 C14.7551919,30.0000116 19.0097352,25.7544158 19.0207645,20.51 Z",id:"路径",fill:"#000000"})))),h=(0,e.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http:www.w3.org/2000/svg"},(0,e.createElement)("path",{d:"M12.3171 7.57538C12.6317 7.77102 12.6317 8.22898 12.3171 8.42462L4.01401 13.5871C3.68095 13.7942 3.25 13.5547 3.25 13.1625V2.83747C3.25 2.44528 3.68095 2.20577 4.01401 2.41285L12.3171 7.57538Z",stroke:"white",strokeWidth:"1.5"})),w=({href:t,className:a,children:o,onClick:n,disabled:l})=>(0,e.createElement)("a",{href:t,target:"blank",onClick:n,className:c()("tiktok-feed__button",a,l&&"tiktok-feed__button--disabled")},o);function E(e,t){const{hashtag:a,source:o}=e,{username:n}=t;switch(o){case"account":case"username":return`https://www.tiktok.com/@${n}`;case"hashtag":return`https://www.tiktok.com/tag/${a}`;default:return"https://www.tiktok.com"}}const b=(C=({userProfile:t={},feedSettings:a={},onClick:o,createTime:n})=>{const l=!!a?.button?.display,i=!!a?.button_load?.display;return(0,e.createElement)("div",{className:"tiktok-feed__actions"},l&&(0,e.createElement)(w,{href:E(a,t),target:"blank",className:"tiktok-feed__button--follow"},_,a.button.text),i&&["account","username","hashtag"].includes(a.source)&&(0,e.createElement)(w,{className:"tiktok-feed__button--load",onClick:o,disabled:0===n},_,a.button_load.text))},t=>{const{feedSettings:a}=t,o=!!a.button.display,n=!!a.button_load.display;return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("style",null,o&&`\n                #tiktok-feed-feed-${a.id} .tiktok-feed__actions .tiktok-feed__button--follow {\n                  color: ${a.button.text_color};\n                }\n\n                #tiktok-feed-feed-${a.id} .tiktok-feed__actions .tiktok-feed__button--follow {\n                  background-color: ${a.button.background};\n                }\n\n                #tiktok-feed-feed-${a.id} .tiktok-feed__actions .tiktok-feed__button--follow:hover {\n                  background-color: ${a.button.background_hover};\n                }\n              `,n&&`\n                #tiktok-feed-feed-${a.id} .tiktok-feed__actions .tiktok-feed__button--load {\n                  color: ${a.button_load.text_color};\n                }\n\n                #tiktok-feed-feed-${a.id} .tiktok-feed__actions .tiktok-feed__button--load {\n                  background-color: ${a.button_load.background};\n                }\n\n                #tiktok-feed-feed-${a.id} .tiktok-feed__actions .tiktok-feed__button--load:hover {\n                  background-color: ${a.button_load.background_hover};\n                }\n              `),(0,e.createElement)(C,t))});var C;const v=()=>{const t=window?.qlttf_frontend?.settings?.spinner_image_url;return(0,e.createElement)("div",{className:"tiktok-feed__spinner",style:t?{backgroundImage:`url(${t})`}:{}})},y=({errorUserProfile:t,errorUserVideoList:a})=>(0,e.createElement)("div",{className:"tiktok-feed__alert"},(0,e.createElement)("ul",null,t&&(0,e.createElement)("li",null,(0,e.createElement)("b",null,t.error),(0,e.createElement)("p",null,t.message)),a&&(0,e.createElement)("li",null,(0,e.createElement)("b",null,a.error),(0,e.createElement)("p",null,a.message)))),x=(0,e.memo)((({feedSettings:t,userProfile:a})=>(0,e.createElement)("div",{className:"tiktok-feed__profile"},(0,e.createElement)("div",{className:"avatar"},(0,e.createElement)("img",{src:t.profile.avatar?t.profile.avatar:a.avatar,alt:t.profile.nickname?t.profile.nickname:a.nickname})),(0,e.createElement)("div",{className:"info"},(0,e.createElement)("div",null,(0,e.createElement)("span",{className:"user"},"@",t.profile.username?t.profile.username:a.username),!!t.profile.nickname&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("span",{className:"separator"},"•"),(0,e.createElement)("span",{className:"user"},t.profile.nickname)),(0,e.createElement)("span",{className:"separator"},"•"),(0,e.createElement)("a",{className:"follow",href:t.profile.username?`https://www.tiktok.com/@${t.profile.username}`:a.link,target:"_blank",rel:"noopener noreferrer"},t.profile.link_text?t.profile.link_text:"Follow"),(0,e.createElement)("div",{className:"biography"},t.profile.biography?t.profile.biography:a.biography)))))),N=({feedSettings:t,feedItem:a})=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"tiktok-feed-item__video-mask"}),(0,e.createElement)("div",{className:"tiktok-feed-item__video-mask--content"},!!t.mask.likes_count&&(0,e.createElement)("span",{className:"tiktok-feed-item__likes_count--mask"},(0,e.createElement)("i",{className:"qlttf-icon-heart tiktok-feed-item__icon-heart"}),a.likes_count),!!t.mask.comments_count&&(0,e.createElement)("span",{className:"tiktok-feed-item__comments_count--mask"},(0,e.createElement)("i",{className:"qlttf-icon-comment tiktok-feed-item__icon-bubble_chat"}),a.comments_count)));window.React;const I="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHN0eWxlPSItbXMtdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTsgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOyB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOyI+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTE2IDE3SDJsMy41LTQuNWwyLjUgM2wzLTMuODFBMiAyIDAgMCAxIDEwIDEwVjZIMmEyIDIgMCAwIDAtMiAydjEwYTIgMiAwIDAgMCAyIDJoMTRhMiAyIDAgMCAwIDItMnYtNmgtNS43NXoiLz48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTkgNGgtLjVWMi41YTIuNSAyLjUgMCAwIDAtNSAwVjRIMTNhMSAxIDAgMCAwLTEgMXY0YTEgMSAwIDAgMCAxIDFoNmExIDEgMCAwIDAgMS0xVjVhMSAxIDAgMCAwLTEtMXptLTMgNGExIDEgMCAxIDEgMS0xYTEgMSAwIDAgMS0xIDF6bTEuNS00aC0zVjIuNzVDMTQuNSAyIDE0LjUgMSAxNiAxczEuNSAxIDEuNSAxLjc1eiIvPjwvc3ZnPgo=",S=({feedItem:t,length:a,index:o,feedSettings:n})=>{const{setIsImageLoad:l}=k();return(0,e.createElement)("div",{className:"tiktok-feed-item__video-wrap"},(0,e.createElement)("img",{width:t.width?t.width:180,height:t.height?t.height:180,alt:"TikTok",className:"tiktok-feed-item__video",loading:n.lazy&&"lazy",src:t.cover_image_url?t.cover_image_url:I,onLoad:()=>{(n.lazy||o===a-1)&&l(!0)}}),n.mask.display&&(0,e.createElement)(N,{feedItem:t,feedSettings:n}),(0,e.createElement)("a",{className:"tiktok-feed-item__icon tiktok-feed-item__icon--views_count",href:t.share_url,target:"_blank",rel:"noreferrer"},h,(0,e.createElement)("span",null,t.views_count)))},L=e=>{const t=e.highlight.tag?.split(" ");return t.map((e=>e.includes("#")?e:e.split(" ").map((e=>"#"+e)).join(" ")))},T=(0,e.memo)((({feedSettings:t,feedItem:a})=>(0,e.createElement)("div",{className:"tiktok-feed-item__video-card"},(0,e.createElement)("div",{className:"tiktok-feed-item__info"},(0,e.createElement)("div",{className:"tiktok-feed-item__date"},a.date),(0,e.createElement)("div",{className:"tiktok-feed-item__icons"},!!t.card.likes_count&&(0,e.createElement)("span",{className:"tiktok-feed-item__likes_count"},(0,e.createElement)("i",{className:"qlttf-icon-heart"}),a.likes_count),!!t.card.comments_count&&(0,e.createElement)("span",{className:"tiktok-feed-item__comments_count"},(0,e.createElement)("i",{className:"qlttf-icon-comment"}),a.comments_count))),!!t.card.video_description&&(0,e.createElement)("p",{className:"tiktok-feed-item__video_description"},((e,t)=>{const a=e.replace(/<[^>]+>/g,"");let o=a;return o=e.match("[぀-ヿ㐀-䶿一-鿿豈-﫿ｦ-ﾟ]")?a.split("",t).join(""):a.split(" ",t).join(" "),o.length<e.length?`${o}...`:o})(a.video_description,t.card.max_word_count))))),P=({index:t,length:a,feedSettings:o,feedItem:n,onClick:l,isLink:i})=>{const r=function(e,t,a){if(!["highlight","highlight-square"].includes(e.layout))return!1;if(!e?.highlight)return!1;for(const o in e.highlight){const n=e.highlight[o].split(",").map((e=>e.toString().trim()));switch(o){case"position":if(n.includes(a.toString()))return!0;break;case"id":if(n.includes(t.id))return!0;break;case"tag":const o=t.tags?.filter((t=>L(e).includes(t))).length;if(o)return!0}}return!1}(o,n,t),s=function(e){return["carousel","carousel-vertical"].includes(e.layout)}(o);return(0,e.createElement)("div",{className:c()("tiktok-feed-item","ig-image-loaded",s&&"swiper-slide",r&&"highlight",`tiktok-feed-item--cols-${o.columns}`),"data-elementor-open-lightbox":"no","data-feed-item-index":t,onClick:l,target:i?"_blank":void 0,href:i?n.share_url:void 0,title:i?n.video_description:void 0},(0,e.createElement)("div",{className:"tiktok-feed-item__wrap"},(0,e.createElement)(S,{index:t,feedItem:n,length:a,feedSettings:o}),o.card.display&&(0,e.createElement)(T,{feedItem:n,feedSettings:o})))},D=function(t,a){const o=(0,e.useRef)();return(0,e.useCallback)((e=>{e?o.current=t(e):o.current&&o.current()}),a)},M=(0,e.memo)((({currentFeedItem:t,feedSettings:a})=>{const[o,n]=(0,e.useState)(!0),l=D((e=>{const{ownerDocument:t}=e,a=t.createElement("script");return a.src="https://www.tiktok.com/embed.js",a.async=!0,t.body.appendChild(a),()=>{t.body.removeChild(a)}}));return(0,e.createElement)("section",{ref:l,className:c()("tiktok-feed-modal__video-container",t.embed_html?"tiktok-feed-modal__video-container--iframe":"tiktok-feed-modal__video-container--video")},t.embed_html?(0,e.createElement)("div",{className:"tiktok-feed-modal__iframe-container",dangerouslySetInnerHTML:{__html:t.embed_html},style:{height:(i=t.height,i>2e3?"600px":"560px")}}):(0,e.createElement)(e.Fragment,null,(0,e.createElement)("video",{autoPlay:!!a.modal.autoplay,className:"tiktok-feed-modal__video",controls:!!a.modal.controls,controlsList:"nodownload",onLoadStart:()=>n(!0),onLoadedData:()=>n(!1),style:!!o&&{display:"none"}||{},src:t.video_url,type:"video/mp4"}),!!o&&(0,e.createElement)("div",{className:"tiktok-feed-modal__spinner"},(0,e.createElement)("img",{alt:"TikTok",className:"tiktok-feed-modal__spinner--img",src:t.cover_image_url?t.cover_image_url:I}),(0,e.createElement)(v,null))));var i})),F=(t=>(a,o)=>{const{feedSettings:n}=a,i=!!n.modal.align;return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("style",null,i&&`\n            #tiktok-feed-modal-${n.id} .tiktok-feed-modal .tiktok-feed-modal__body .tiktok-feed-modal__video-info .tiktok-feed-modal__video_description {\n              text-align: ${n.modal.align};\n            }\n          `),(0,e.createElement)(t,l({},a,{forwardRef:o})))})((({currentFeedItem:t,userProfile:a,feedItemsNumber:o,feedSettings:n})=>{const{currentFeedIndex:l}=k(),i=!!t.profile;return(0,e.createElement)("section",{className:"tiktok-feed-modal__video-info"},!!n.modal.profile&&(0,e.createElement)("div",{className:"tiktok-feed-modal__profile"},(0,e.createElement)("img",{src:i?t.profile.avatar:a.avatar}),(0,e.createElement)("div",null,(0,e.createElement)("span",null,i?t.profile.nickname:a.nickname),(0,e.createElement)("a",{href:i?t.profile.link:a.link,title:i?t.profile.nickname:a.nickname,target:"_blank",rel:"noopener noreferrer"},`@${i?t.profile.username:a.username}`))),(0,e.createElement)("div",{className:"tiktok-feed-modal__icons"},(0,e.createElement)("span",{className:"tiktok-feed-modal__counter"},`${l+1} / ${o}`),(0,e.createElement)("a",{className:"tiktok-feed-modal__link",href:t.share_url,target:"_blank",rel:"noopener noreferrer"},g,"TikTok")),!!n.modal.video_description&&(0,e.createElement)("p",{className:"tiktok-feed-modal__video_description",dangerouslySetInnerHTML:{__html:t.video_description}}),(0,e.createElement)("div",{className:"tiktok-feed-modal__info"},!!n.modal.likes_count&&(0,e.createElement)("span",{className:"tiktok-feed-modal__likes_count"},(0,e.createElement)("i",{className:"qlttf-icon-heart"}),t.likes_count),!!n.modal.date&&(0,e.createElement)("span",{className:"tiktok-feed-modal__date"},t.date),!!n.modal.comments_count&&(0,e.createElement)("span",{className:"tiktok-feed-modal__comments_count"},(0,e.createElement)("i",{className:"qlttf-icon-comment"}),t.comments_count)))})),A=({isPrevious:t,classname:a,onClick:o})=>(0,e.createElement)("span",{className:c()("tiktok-feed-modal__button-arrow",a,t&&"qlttf-icon-prev",!t&&"qlttf-icon-next"),onClick:o}),B=({onClick:t})=>(0,e.createElement)("span",{className:"tiktok-feed-modal__button-close",onClick:t}),q=({children:t,id:a})=>{const{isOpen:o,setIsOpen:n}=k();return o?(0,e.createElement)("div",{className:"tiktok-feed-modal__overlay",id:a,onClick:()=>n(!1)},t):null},$=({feedListItems:t,feedSettings:a,userProfile:o})=>{const{currentFeedIndex:n,setCurrentFeedIndex:l}=k(),{setIsOpen:i}=k(),[r,c]=(0,e.useState)(t[n]),s=!!t[n-1],d=!!t[n+1];return(0,e.useEffect)((()=>{c(t[n])}),[n]),(0,e.createElement)(q,{id:`tiktok-feed-modal-${a.id}`},(0,e.createElement)("div",{className:"tiktok-feed-modal",onClick:e=>e.stopPropagation()},(0,e.createElement)("div",{className:"tiktok-feed-modal__options"},(0,e.createElement)("div",{className:"tiktok-feed-modal__options--arrows"},(0,e.createElement)(A,{isPrevious:!0,onClick:e=>{e.stopPropagation(),l(s?n-1:t.length-1)}}),(0,e.createElement)(A,{next:!0,onClick:e=>{e.stopPropagation(),l(d?n+1:0)}})),(0,e.createElement)(B,{onClick:()=>i(!1)})),(0,e.createElement)("section",{className:"tiktok-feed-modal__body"},(0,e.createElement)(M,{feedSettings:a,currentFeedItem:r}),(0,e.createElement)(F,{feedSettings:a,currentFeedItem:r,userProfile:o,feedItemsNumber:t.length}))))},R=(0,e.forwardRef)((t=>(a,o)=>{const{feedSettings:n}=a,i=!!n.box.display,r="carousel-vertical"==n.layout,c="carousel"==n.layout,s="carousel"!==n.layout,d="carousel-vertical"!==n.layout,m=!!n.card.display,u=!!n.mask.display,k=["masonry","highlight","highlight-square"].includes(n.layout);return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("style",null,i&&`#tiktok-feed-feed-${n.id} {\n\t\t\t\t\t\t\t\tbackground-color: ${n.box.background}; \n\t\t\t\t\t\t\t\tcolor: ${n.box.text_color}; \n\t\t\t\t\t\t\t\tborder-radius: ${n.box.radius}px;\n\t\t\t\t\t\t\t\tpadding: ${n.box.padding}px;\n\t\t\t\t\t\t\t}`,(c||r)&&`#tiktok-feed-feed-${n.id} .swiper-container .swiper-button-prev,\n\t\t\t\t\t\t\t#tiktok-feed-feed-${n.id} .swiper-container .swiper-button-next {\n\t\t\t\t\t\t\t\tcolor: ${n.carousel.navarrows_color}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t#tiktok-feed-feed-${n.id} .swiper-container .swiper-pagination .swiper-pagination-bullet {\n\t\t\t\t\t\t\t\tbackground-color: ${n.carousel.pagination_color}\n\t\t\t\t\t\t\t}`,s&&d&&`#tiktok-feed-feed-${n.id} .tiktok-feed-item {\n\t\t\t\t\t\t\t\tpadding: ${n.video.spacing}px;\n\t\t\t\t\t\t\t}`,`#tiktok-feed-feed-${n.id} .tiktok-feed-item__video-wrap {\n\t\t\t\t\t\t\tborder-radius: ${n.video.radius}px; \n\t\t\t\t\t\t\toverflow: hidden;\n              \t\t\t}`,m&&`#tiktok-feed-feed-${n.id} .tiktok-feed-item__wrap {\n\t\t\t\t\t\t\t\tbackground-color: ${n.card.background};\n\t\t\t\t\t\t\t\tcolor: ${n.card.text_color};\n\t\t\t\t\t\t\t\tfont-size: ${n.card.font_size}px;\n\t\t\t\t\t\t\t\tpadding: ${n.card.padding}px;\n\t\t\t\t\t\t\t\tborder-radius: ${n.card.radius}px;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t#tiktok-feed-feed-${n.id} .tiktok-feed-item__wrap:hover {\n\t\t\t\t\t\t\t\tbackground-color: ${n.card.background_hover};\n\t\t\t\t\t\t\t}`,m&&k&&`#tiktok-feed-feed-${n.id} .tiktok-feed-item__wrap {\n\t\t\t\t\t\t\t\twidth: initial !important;\n\t\t\t\t\t\t\t`,u&&`#tiktok-feed-feed-${n.id} .tiktok-feed-item__video-mask { \n                \t\t\t\tbackground-color: ${n.mask.background} !important;\n              \t\t\t\t}`),(0,e.createElement)(t,l({},a,{forwardRef:o})))})((t=>{const a=t.target.parentNode,{masonryRef:o,feedListItems:n,feedSettings:l,className:i,userProfile:r}=t,{currentFeedIndex:s,setCurrentFeedIndex:d}=k(),{setIsOpen:m}=k(),u=!!l?.modal?.display,p=!u;return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{ref:o,className:c()("tiktok-feed-list",i),"data-feed_layout":l.layout},n.map(((t,a)=>{const o=n.length;return(0,e.createElement)(P,{key:t.id,index:a,length:o,feedItem:t,feedSettings:l,onClick:()=>{d(a),m(!0)},isLink:p})}))),u&&(0,e.createPortal)((0,e.createElement)($,{userProfile:r,feedSettings:l,currentFeedIndex:s,feedListItems:n}),a))}))),O=t=>{const{target:a,feedListItems:o,feedSettings:n}=t,[i,r]=(0,e.useState)(!0),c=D((e=>{const{ownerDocument:t}=e,{defaultView:o}=t;if(!o.Masonry)return;const n=new o.Masonry(e,{itemSelector:".tiktok-feed-item",isResizable:!0,isAnimated:!1,transitionDuration:0,percentPosition:!0,columnWidth:".tiktok-feed-item:last-child"});r(!1),a.classList.add("loaded");const l=new o.MutationObserver((()=>{n.layout()})),i=e.querySelector(".tiktok-feed-item__wrap");i&&l.observe(i,{childList:!0,subtree:!0});const c=new ResizeObserver((()=>{n.layout()})),s=e.querySelector(".tiktok-feed-item");return s&&c.observe(s),()=>{l.disconnect(),c.disconnect(),n.destroy()}}),[o]);return(0,e.createElement)(e.Fragment,null,i&&(0,e.createElement)(v,null),(0,e.createElement)(R,l({},t,{masonryRef:c})))},z=t=>{const{feedSettings:a}=t,{setCurrentFeedIndex:o}=k(),{setIsOpen:n}=k(),i=D((e=>{const{defaultView:t}=document;t.Swiper&&(new t.Swiper(e,{slideClass:"tiktok-feed-item",loop:!0,loopedSlidesLimit:!1,centeredSlides:!0,allowTouchMove:!1,slidesPerView:a.carousel.slidespv,spaceBetween:a.video.spacing,autoplay:a.carousel.autoplay&&{delay:a.carousel.autoplay_interval},pagination:{el:e.querySelector(".swiper-pagination"),dynamicBullets:!0,clickable:!0,type:"bullets"},navigation:{nextEl:e.querySelector(".swiper-button-next"),prevEl:e.querySelector(".swiper-button-prev")},breakpoints:{320:{slidesPerView:1,spaceBetween:1},480:{spaceBetween:a.video.spacing,slidesPerView:Math.min(2,a.carousel.slidespv)},768:{spaceBetween:a.video.spacing,slidesPerView:Math.min(3,a.carousel.slidespv)},1024:{spaceBetween:a.video.spacing,slidesPerView:a.carousel.slidespv}}}),e.addEventListener("click",(e=>{(e.target.classList.contains(".swiper-slide-duplicate")||e.target.closest(".swiper-slide-duplicate"))&&(n(!0),o(Number(e.target.closest(".swiper-slide-duplicate").dataset.feedItemIndex)))})))}));return(0,e.createElement)("div",{ref:i,className:"swiper-container"},(0,e.createElement)(R,l({className:c()("swiper-wrapper","carousel"===a.layout&&"tiktok-feed-square")},t)),a.carousel.pagination&&(0,e.createElement)("div",{className:"swiper-pagination"}),a.carousel.navarrows&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{tabIndex:"1",className:"swiper-button-prev"}),(0,e.createElement)("div",{tabIndex:"1",className:"swiper-button-next"})))},V=t=>{const a=(0,e.useRef)();return(0,e.createElement)(R,l({ref:a,className:"tiktok-feed-square"},t))},j=t=>{const{feedListItems:a,target:o,feedSettings:n}=t,{isImageLoad:i}=k(),[r,s]=(0,e.useState)(!0);(0,e.useLayoutEffect)((()=>{}),[a,i]);const d=D((e=>{const{ownerDocument:t}=e,{defaultView:a}=t;if(!a.Masonry)return;const l=new a.Masonry(e,{itemSelector:".tiktok-feed-item",isResizable:!0,isAnimated:!1,transitionDuration:0,percentPosition:!0,columnWidth:(()=>{const t=e?.querySelector(".tiktok-feed-item:not(.highlight)").offsetWidth,a=e?.offsetWidth;return a/(t-n.spacing)})()});s(!1),o.classList.add("loaded");const i=new a.MutationObserver((()=>{l.layout()})),r=e.querySelector(".tiktok-feed-item__wrap");return r&&i.observe(r,{childList:!0,subtree:!0}),()=>{i.disconnect(),l.destroy()}}),[a]);return(0,e.createElement)(e.Fragment,null,r&&(0,e.createElement)(v,null),(0,e.createElement)(R,l({className:c()("highlight-square"===n.layout&&"tiktok-feed-square"),masonryRef:d},t)))},Z=t=>{const{feedSettings:a}=t,{layout:o}=a;switch(o){case"masonry":return(0,e.createElement)(O,t);case"carousel":case"carousel-vertical":return(0,e.createElement)(z,t);case"highlight":case"highlight-square":return(0,e.createElement)(j,t);default:return(0,e.createElement)(V,t)}};async function U({url:e,data:t,method:a}){return await fetch(e,{body:JSON.stringify(t),method:a}).then((e=>e.json())).then((e=>{if(e.code)throw new Error(`${e.code}: ${e?.message||"Unknown"}`);return e})).catch((e=>{throw new Error(e)}))}const W=t=>{const{target:a,feedSettings:o}=t,{isLoadingUserProfile:n,feedProfile:l,errorUserProfile:i,isLoadingUserVideoList:r,isLoadingMore:c,feedListItems:s,errorUserVideoList:d,setCreateTime:m}=(t=>{const[a,o]=(0,e.useState)(!0),[n,l]=(0,e.useState)(!0),[i,r]=(0,e.useState)(!1),[c,s]=(0,e.useState)(null),[d,m]=(0,e.useState)([]),[u,k]=(0,e.useState)(null),[p,f]=(0,e.useState)(null),[_,g]=(0,e.useState)(null),{source:h,limit:w,order_by:E,username:b,open_id:C,hashtag:v,region:y}=t;return(0,e.useEffect)((()=>{f(null),g(null),s(null),o(!0),l(!0)}),[]),(0,e.useEffect)((()=>{(async()=>{r(!0);let e={};try{e=await async function(e){const{source:t}=e;if("account"!==t&&"username"!==t)return;const a=qlttf_frontend.restRoutePaths.profile?.[t];return await U({url:a,method:"POST",data:{feedSettings:e}})}(t),s(e),o(!1)}catch(e){o(!1),f(e)}try{const a=await async function(e,t=""){const{source:a}=e,o=window?.qlttf_frontend?.restRoutePaths?.[a];if(!o)throw new Error(`Unknown source: ${a}`);return await U({url:o,method:"POST",data:{feedSettings:e,createTime:t}})}({...t,username:["account","username"].includes(h)?e.username:""},u);m(null===u?a:[...d,...a]),l(!1),r(!1)}catch(e){l(!1),r(!1),console.error(e),g(e)}})()}),[w,E,b,C,h,v,y,u]),{isLoadingUserProfile:a,feedProfile:c,errorUserProfile:p,isLoadingUserVideoList:n,isLoadingMore:i,feedListItems:d,errorUserVideoList:_,setCreateTime:k}})(o),u=n||r,k=i||d,p=["account","username"].includes(o.source)?l:o.profile;return(0,e.useEffect)((()=>{u||a.classList.add("loaded")}),[u]),u?(0,e.createElement)(v,null):k?(0,e.createElement)(y,{errorUserProfile:i,errorUserVideoList:d}):(0,e.createElement)(e.Fragment,null,!!o?.profile?.display&&(0,e.createElement)(x,{feedSettings:o,userProfile:p}),(0,e.createElement)(Z,{target:a,feedSettings:o,feedListItems:s,userProfile:p}),c&&(0,e.createElement)(v,null),(0,e.createElement)(b,{userProfile:p,feedSettings:o,onClick:e=>{e.preventDefault(),m(s[s.length-1]?.create_time)},createTime:s[s.length-1]?.create_time}))},H=t=>{const{attributes:a,setAttributes:o}=t,l=(0,e.useRef)(null),i=(0,n.useBlockProps)({className:"qlttf-box-editor"}),r=(0,d.useInstanceId)(H,"qlttf");return(0,e.useEffect)((()=>{o({id:r})}),[r,o]),(0,e.createElement)("div",i,(0,e.createElement)("div",{className:"tiktok-feed-feed",ref:l,id:`tiktok-feed-feed-${r}`},!!l?.current&&(0,e.createElement)(f,null,(0,e.createElement)(W,{target:l.current,feedSettings:a}))))},G=(0,e.forwardRef)(H),J=t=>{const{href:a,target:o="_self",title:n,children:l,className:i}=t;return(0,e.createElement)("a",{href:a,className:c()("tiktok__account-button",i),target:o,title:n},l)},Y=a=>(0,e.createElement)(s.Placeholder,{label:(0,t.__)("Please create access token","wp-tiktok-feed"),instructions:(0,e.createElement)(e.Fragment,null,(0,e.createElement)("p",null,(0,t.__)("Before you start creating feeds, you have to create an access token. Please go to the account tab to connect your Instagram account and then reload this page.","wp-tiktok-feed")),(0,e.createElement)("p",null,(0,e.createElement)(J,{href:qlttf_gutenberg.access_token_link,target:"_blank",title:(0,t.__)("Add Account","wp-tiktok-feed")},(0,t.__)("Add Personal Account","wp-tiktok-feed"))))}),X=({attributes:a,setAttributes:o,accounts:n})=>(0,e.createElement)(s.Placeholder,{label:(0,t.__)("Please select account","wp-tiktok-feed"),instructions:(0,e.createElement)(e.Fragment,null,(0,e.createElement)("p",null,(0,t.__)("Before you start creating feeds, you have to select your Instagram account.","wp-tiktok-feed")),(0,e.createElement)("p",null,(0,e.createElement)(s.RadioControl,{selected:a.open_id,onChange:e=>o({open_id:e}),options:n?.map(((e,t)=>({value:e.open_id,label:e.nickname||e.username})))})))}),{U:Q}={U:"qlttf/box"};(0,o.registerBlockType)(Q,{title:(0,t.__)("Tiktok Feed","wp-tiktok-feed"),description:(0,t.__)("Display beautiful and responsive galleries on your website from your Tiktok feed account.","wp-tiktok-feed"),icon:"awards",keywords:[(0,t.__)("qltff","wp-tiktok-feed"),(0,t.__)("instagram","wp-tiktok-feed"),(0,t.__)("quadlayers","wp-tiktok-feed")],edit:a=>{const{attributes:o}=a,{accounts:n,hasResolvedAccounts:r}=(0,i.useAccountsEntities)();return r?n&&0!==n.length?n?.find((e=>e.open_id===o.open_id))?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(m,a),(0,e.createElement)(G,a)):(0,e.createElement)(X,l({},a,{accounts:n})):(0,e.createElement)(Y,a):(0,e.createElement)("p",null,(0,e.createElement)("span",{style:{visibility:"visible"},className:"spinner"}),(0,t.__)("Loading…","wp-tiktok-feed"))},save:t=>(0,e.createElement)(n.InnerBlocks.Content,null)})})()})();